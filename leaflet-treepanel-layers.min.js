/*! agriculture-platform-web 2017-11-14 */

!function(e){if("function"==typeof define&&define.amd)define(["leaflet"],e);else if("undefined"!=typeof module)module.exports=e(require("leaflet"));else{if(void 0===window.L)throw"Leaflet must be loaded first";e(window.L)}}(function(e){function t(e){for(;e.firstChild;)e.removeChild(e.firstChild)}return e.Control.TreePanelLayers=e.Control.Layers.extend({options:{compact:!1,collapsed:!1,autoZIndex:!0,collapsibleGroups:!1,buildItem:null,title:"",className:"",position:"topright"},initialize:function(t){e.setOptions(this,t),this._layers=[],this._parents=[],this._layerControlInputs=[]},onAdd:function(t){return e.Control.Layers.prototype.onAdd.call(this,t),this._container.className+=" leaflet-treepanel-layers",this._container},addTreeOverlay:function(e,t){return this._addLayer(e,t),this._map?this._update():this},_addLayer:function(t,n){this._parents.push({name:t.name,icon:t.icon,items:n.length});for(var a=0;a<n.length;a++){var r=n[a];this._map&&r.layer.on("add remove",this._onLayerChange,this),this._layers.push({layer:r.layer,name:r.name,icon:r.icon,color:r.color,overlay:!0}),this.options.sortLayers&&this._layers.sort(e.bind(function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)},this)),this.options.autoZIndex&&r.layer.setZIndex&&(this._lastZIndex++,r.layer.setZIndex(this._lastZIndex))}this._expandIfNotCollapsed()},_addItem:function(t,n){var a=document.createElement("div");a.innerHTML=t.icon;var r=document.createElement("span");r.innerText=t.name;var i=document.createElement("li");i.className="level-one",i.appendChild(a),i.appendChild(r),this.topUl.appendChild(i);var l=document.createElement("ul");l.className="level-two",i.appendChild(l);for(var o=0;o<n.length;o++){var s=n[o],d=this._map.hasLayer(s.layer),h=document.createElement("div");h.innerHTML=s.icon;var p=h.firstChild;p&&(p.style.color=s.color);var c=document.createElement("input");c.type="checkbox",c.defaultChecked=d;var u=document.createElement("label");u.appendChild(c),this._layerControlInputs.push(c),c.layerId=e.stamp(s.layer),e.DomEvent.on(c,"click",this._onInputClick,this);var m=document.createTextNode(s.name);u.appendChild(m);var y=document.createElement("li");y.appendChild(h),y.appendChild(u),l.appendChild(y)}this._checkDisabledLayers()},_update:function(){if(!this._container)return this;t(this._overlaysList),this.topUl=document.createElement("ul"),this.topUl.className="treepanel",this._overlaysList.appendChild(this.topUl),this._layerControlInputs=[];for(var e,n=0,a=0;n<this._parents.length;n++){for(var r=this._parents[n],i=[],l=0;l<r.items;l++,a++)e=this._layers[a],i.push(e);this._addItem(r,i)}return this._separator.style.display="none",this}}),e.Control.TreePanelLayers.include(e.Evented.prototype),e.control.treePanelLayers=function(t,n,a){return new e.Control.TreePanelLayers(t,n,a)},e.Control.TreePanelLayers});